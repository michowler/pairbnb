<!DOCTYPE html>
<html>
<head>
  <title>Mingle</title>
  <%= stylesheet_link_tag 'application' %>
  <%= javascript_include_tag 'application' %>
  <%= csrf_meta_tag %>
  <script src="https://cdn.jsdelivr.net/jquery/1.12.4/jquery.min.js"></script>
  <script src="parsley.min.js"></script>
  <script src="https://cdn.jsdelivr.net/jquery.validation/1.15.1/jquery.validate.min.js"></script>

</head>

<body>

<div id="header">
    <% if signed_in? -%>
    <nav class="navbar navbar-inverse">
      <div class="container-fluid">

        <div class="navbar-header">
          <%= link_to 'Mingle', root_path, class: 'navbar-brand' %>
            <span class= 'navbar-brand' id="main" style="font-size:15px;cursor:pointer" onclick="openNav()">&#9776; more info</span>
              <div id="mySidenav" class="sidenav">
                <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
                <%= link_to "Become a host", new_listing_path %>
                <p>Tags: <% Tag.all.each do |t|%></p>
                  <%=link_to t.tag_content, tag_listings_path(t.id)%>
                <%end%>
              </div>
                <%= form_tag(listings_path, :method => "get", id: "search-form") do %>
                    <%= text_field_tag :search, params[:search], placeholder: "Search Listings" %>
                    <%= submit_tag "Search", :name => nil %>
                <% end %>
        </div>

        <div class="nav navbar-nav pull-right">
          <span> <a href= "/users/<%=current_user.id%>" class='navbar-brand'>Welcome back <%=current_user.email%> </a></span>
          <li><%= button_to t(".sign_out"), sign_out_path, method: :delete %></li>
         </div> 
       </div>   

    <% else -%>

    <nav class="navbar navbar-inverse">
      <div class="container-fluid">
        <div class="navbar-header">
          <%= link_to 'Mingle', root_path, class: 'navbar-brand' %>
          <span class= 'navbar-brand' id="main" style="font-size:15px;cursor:pointer" onclick="openNav()">&#9776; more info</span>
            <div id="mySidenav" class="sidenav">
              <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
              <%= link_to "Become a host", new_listing_path %>
              <p>Tags: <% Tag.all.each do |t|%></p>
                <%=link_to t.tag_content, tag_listings_path(t.id)%>
              <%end%>
            </div>
            
        </div>

        <ul class="nav navbar-nav navbar-right">
              <li><a data-toggle="modal" data-target="#mySignUpModal"><span class="glyphicon glyphicon-user" ></span> Sign Up</a></li>
              <li><a data-toggle="modal" data-target="#myLogInModal"><span class="glyphicon glyphicon-log-in"></span> Login</a></li>
        </ul>

        <div class="container">
          <!-- Modal -->
          <div class="modal fade" id="mySignUpModal" role="dialog">
            <div class="modal-dialog">
            
              <!-- Modal content-->
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title">Sign up</h4>
                </div>
                <div class="modal-body">
                <%= form_for User.new do |form| %>
                  <%= render partial: '/users/form', object: form %>
                <% end %>
                 
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-primary" data-dismiss="modal" data-toggle="modal" data-target="#myLogInModal">Log In?</button>
                </div>
              </div>
              
            </div>
          </div>

          <!-- Modal -->
          <div id="myLogInModal" class="modal fade" role="dialog">
            <div class="modal-dialog">

              <!-- Modal content-->
              <div class="modal-content">
                <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal">&times;</button>
                  <h4 class="modal-title">Log In</h4>
                </div>
                <div class="modal-body">
                  <%= render 'sessions/form' %>
                  <%= button_to "Sign in with FB", "/auth/facebook", :class => "btn btn-primary", :method => :get %>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-primary" data-dismiss="modal" data-toggle="modal" data-target="#mySignUpModal">Sign Up?</button>
                </div>
              </div>

            </div>
          </div>
        </div>  
        </div>

    <% end -%>
  </div>

  <div class="container">
    <%= flash_messages %>
    <%= yield %>
  </div>

</body>
</html>
